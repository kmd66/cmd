function JsShowAlert(n){new Alert({type:n.type,message:n.message,expires:n.expires,withProgress:n.withProgress,container:n.container})}function PageInit(){getGallery();setMainSlideRightLastChild();setCommentEl();getScores();callXzoom();getMany()}function setNavbar(){var t=document.getElementById("navbar"),n=document.getElementById("fixNavbar"),i;t&&n&&(n.innerHTML="",NodeList.prototype.forEach=Array.prototype.forEach,i=t.childNodes,i.forEach(function(t){var i=t.cloneNode(!0);n.appendChild(i)}),document.getElementById("fixNavbar").classList.remove("disable"))}function setMainSlideRightLastChild(){var t,n,i,r;(resetMainSlideRightLastChild(),t=$(".mainSlideRight").first(),n=$(".mainSlideRight div:last-child").first(),t.length!=0&&n.length!=0)&&(i=n.offset().top+n.width()+300,r=$(".mainSlideLeft").height()+$(".mainSlideLeft").offset().top,mainSlideRightLastChildOffset={b:i<r,y:n.offset().top,x:n.offset().left,w:n.width(),h:n.height(),p:0,p_y:t.offset().top,p_h:t.height()})}function resetMainSlideRightLastChild(){mainSlideRightLastChildOffset={};var t=$(".mainSlideRight").first(),n=$(".mainSlideRight div:last-child").first();t.length!=0&&n.length!=0&&(n.first().removeClass("mainSlideLeftLastAbsolute"),n.first().removeClass("mainSlideLeftLastFix"))}function setMainSlideRightLastChildOffset(n){if(mainSlideRightLastChildOffset&&mainSlideRightLastChildOffset.b){if(screen.width<=768){resetMainSlideRightLastChild();return}mainSlideRightLastChildOffset.p==1&&n.scrollY<mainSlideRightLastChildOffset.y-80&&($(".mainSlideRight div:last-child").first().removeClass("mainSlideLeftLastFix"),mainSlideRightLastChildOffset.p=0);mainSlideRightLastChildOffset.p==1&&n.scrollY+mainSlideRightLastChildOffset.h+80>mainSlideRightLastChildOffset.p_y+mainSlideRightLastChildOffset.p_h&&($(".mainSlideRight div:last-child").first().removeClass("mainSlideLeftLastFix"),$(".mainSlideRight div:last-child").first().addClass("mainSlideLeftLastAbsolute"),mainSlideRightLastChildOffset.p=2);mainSlideRightLastChildOffset.p==2&&n.scrollY+mainSlideRightLastChildOffset.h+80<mainSlideRightLastChildOffset.p_y+mainSlideRightLastChildOffset.p_h&&($(".mainSlideRight div:last-child").first().removeClass("mainSlideLeftLastAbsolute"),$(".mainSlideRight div:last-child").first().addClass("mainSlideLeftLastFix"),mainSlideRightLastChildOffset.p=1);!mainSlideRightLastChildOffset.p&&n.scrollY>mainSlideRightLastChildOffset.y-80&&($(".mainSlideRight div:last-child").first().addClass("mainSlideLeftLastFix"),mainSlideRightLastChildOffset.p=1)}}function showGetToTop(n){var t=document.getElementById("getToTop");n.scrollY>450&&t?.className.indexOf("d-hide")>-1&&document.getElementById("getToTop").classList.remove("d-hide");n.scrollY<450&&t?.className.indexOf("d-hide")==-1&&document.getElementById("getToTop").classList.add("d-hide")}function showFixNavbar(n){var t=document.getElementById("fixNavbar");n.scrollY>450&&t?.className.indexOf("d-hide")>-1&&document.getElementById("fixNavbar").classList.remove("d-hide");n.scrollY<450&&t?.className.indexOf("d-hide")==-1&&document.getElementById("fixNavbar").classList.add("d-hide")}function setCommentEl(){$(".commentUserAvatar").each(function(n,t){$(t).css("background-color",getRandomColor())});$(".commentScore").each(function(n,t){var i=$(t).data("score")-1;$(t).empty();for(let n=0;n<5;n++)n<=i?$(t).append('<span class= "star2 active"><\/span >'):$(t).append('<span class= "star2"><\/span >')})}function getRandomColor(){for(var n="#",t=0;t<6;t++)n+="0123456789ABCDEF"[Math.floor(Math.random()*16)];return n}function getScores(){var n=".star",t=".selected";$(n).unbind("click");$(n).on("click",function(){$(t).each(function(){$(this).removeClass("selected")});$(this).addClass("selected")})}function getMany(){$(".many").each(function(n,t){var i=formatMoney($(t).text().trim().replaceAll(",",""));$(t).text(i)})}function formatMoney(n,t=0,i=".",r=","){try{t=Math.abs(t);t=isNaN(t)?0:t;const e=n<0?"-":"";let u=parseInt(n=Math.abs(Number(n)||0).toFixed(t)).toString(),f=u.length>3?u.length%3:0;return e+(f?u.substr(0,f)+r:"")+u.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+r)+(t?i+Math.abs(n-u).toFixed(t).slice(2):"")}catch(u){return"0"}}function getGallery(){var n=[],t;$("img.g").each(function(t,i){n.push({at:$(i).attr("slide"),obj:i})});const i=groupBy(n,n=>n.at);i.forEach(n=>{n.forEach((n,i)=>{$(n.obj).addClass("cGallery");$(n.obj).attr("galleryId",i);var r=$(n.obj).parent();i==0?(r.addClass("pGallery"),t=r,r.empty()):r.remove();t.append(n.obj)})});eventGallery()}function eventGallery(){$("img.g").unbind("click");$("#galleryClose").unbind("click");$("#galleryNext").unbind("click");$("#galleryPrev").unbind("click");$("img.g").click(function(){const i=$(this).attr("slide"),r=$(this).attr("src").replace("-thumbnail",""),n=$(`[slide=${i}]`);n.length>1?($("#galleryNext").css("visibility","visible"),$("#galleryPrev").css("visibility","visible")):($("#galleryNext").css("visibility","hidden"),$("#galleryPrev").css("visibility","hidden"));const t=$("#galleryModalDialog");console.log(`${$(this).attr("galleryId")} | ${$(this).attr("slide")} | ${n.length}`);t.empty();t.append(`<img class="c" src="${r}" style="max-height: ${$(window).height()-40}px" galleryId="${$(this).attr("galleryId")}" slideD="${$(this).attr("slide")}">`);$("#galleryModal").modal("show")});$("#galleryClose").click(function(){$("#galleryModal").modal("hide")});$("#galleryNext").click(function(){moveGallery(!0)});$("#galleryPrev").click(function(){moveGallery(!0)})}function moveGallery(n){var o,f,t;const r=$("#galleryModalDialog img:first-child");o=r.attr("slideD");const i=$(`[slide=${r.attr("slideD")}]`);f=Array.from(i);const e=$("#galleryModalDialog");t=0;f.forEach((n,i)=>{$(n).attr("galleryId")==r.attr("galleryId")&&(t=i)});n?t++:t--;t<0&&(t=i.length-1);t>i.length-1&&(t=0);e.empty();const u=i[t],s=$(u).attr("src").replace("-thumbnail","");e.append(`<img class="c" src="${s}" style="max-height: ${$(window).height()-40}px" galleryId="${$(u).attr("galleryId")}" slideD="${$(u).attr("slide")}">`)}function CopyToClipboard(n){navigator.clipboard.writeText(n)}function ShowLoad(){$("#loding").addClass("d-block")}function HideLoad(){$("#loding").removeClass("d-block")}function OpenNewTab(n){window.open(n,"_blank")}function ShowModal(n){$(`#${n}`).modal("show")}function HideModal(n){$(`#${n}`).modal("hide")}async function saveFile(n){var r=document.getElementById(n.fileId),i=r.files[0];if(!i)return{Success:!1,Message:"فایل انتخاب نشده"};let t=new FormData;return t.append("file",i),t.append("dir",n.dir),$.ajax({type:"POST",mimeTypes:"multipart/form-data",url:"/api/Attachment/Upload",data:t,headers:{Authorization:n.token},contentType:!1,cache:!1,processData:!1,timeout:8e5}).then(t=>($(`#${n.fileId}`).val(""),t)).catch(n=>({Success:!1,Message:n.statusText,Code:n.status}))}function ScrollIntoView(n){const t=document.getElementById(n).getBoundingClientRect().top+window.scrollY;window.scroll({top:t-50,behavior:"smooth"})}function groupBy(n,t){const i=new Map;return n.forEach(n=>{const r=t(n),u=i.get(r);u?u.push(n):i.set(r,[n])}),i}function groupBy(n,t){const i=new Map;return n.forEach(n=>{const r=t(n),u=i.get(r);u?u.push(n):i.set(r,[n])}),i}function getToTop(){document.documentElement.scrollIntoView({behavior:"smooth"})}function showNavSearch(){getToTop();var n=document.getElementById("navSearch");n?.className.indexOf("d-none")>-1&&n.classList.remove("d-none")}function hideNavSearch(){getToTop();var n=document.getElementById("navSearch");n?.className.indexOf("d-none")==-1&&n.classList.add("d-none")}function showOffcanvas(n){var t=document.getElementById(n);t?.className.indexOf("show")==-1&&(t.classList.add("show"),document.body.classList.add("bodyOverflowHide"))}function hideOffcanvas(n){var t=document.getElementById(n);t?.className.indexOf("show")>-1&&(t.classList.remove("show"),document.body.classList.remove("bodyOverflowHide"))}function InitHomeSlide(){function t(n){HomeSlideMove=!0;var t=$("#homeSlider ul li:last-child"),i=document.getElementById("bHomeSlider");t&&i&&(f(t),$("#homeSlider ul").animate({left:+n},1e3,function(){HomeSlideMove=!1;t.prependTo("#homeSlider ul");$("#homeSlider ul").css("left","");i.innerHTML=""}))}function u(){t(n*-1)}function i(){t(n)}function f(n){var t=document.getElementById("bHomeSlider"),i;if(!t){clearInterval(HomeSlideObj);return}t.innerHTML="";NodeList.prototype.forEach=Array.prototype.forEach;i=n[0].childNodes;i.forEach(function(n){var i=n.cloneNode(!0);t.appendChild(i)})}HomeSlideObj&&clearInterval(HomeSlideObj);HomeSlideObj=setInterval(function(){i()},3e3);var r=$("#homeSlider ul li").length,n=$("#homeSlider ul li").width(),e=$("#homeSlider ul li").height(),o=r*n;$("span.control_prev").click(function(){HomeSlideMove||(HomeSlideObj&&clearInterval(HomeSlideObj),i())});$("span.control_next").click(function(){HomeSlideMove||(HomeSlideObj&&clearInterval(HomeSlideObj),u())})}function callXzoom(){$(".xzoom, .xzoom-gallery").xzoom({zoomWidth:400,title:!0,tint:"#333",Xoffset:15});$(".xzoom2, .xzoom-gallery2").xzoom({zoomWidth:300,position:"#xzoom2-id",tint:"#ffa200"});$(".xzoom3, .xzoom-gallery3").xzoom({zoomWidth:300,position:"lens",lensShape:"circle",sourceClass:"xzoom-hidden"});$(".xzoom4, .xzoom-gallery4").xzoom({zoomWidth:300,tint:"#006699",Xoffset:15});$(".xzoom5, .xzoom-gallery5").xzoom({zoomWidth:300,int:"#006699",Xoffset:15});var n="ontouchstart"in window;n?$(".xzoom, .xzoom2, .xzoom3, .xzoom4, .xzoom5").each(function(){var n=$(this).data("xzoom");n.eventunbind()}):($("#xzoom-fancy").bind("click",function(n){var t=$(this).data("xzoom");t.closezoom();$.fancybox.open(t.gallery().cgallery,{padding:0,helpers:{overlay:{locked:!1}}});n.preventDefault()}),$("#xzoom-magnific").bind("click",function(n){var u=$(this).data("xzoom"),t,i,r;u.closezoom();t=u.gallery().cgallery;r=[];for(i in t)r[i]={src:t[i]};$.magnificPopup.open({items:r,type:"image",gallery:{enabled:!0}});n.preventDefault()}))}function detect_old_ie(){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var n=new Number(RegExp.$1);return!(9<=n)&&(8<=n||7<=n||6<=n||5<=n||void 0)}return!1}var mainSlideRightLastChildOffset,HomeSlideObj,HomeSlideMove;class $Alert{constructor(n={}){this.container=document.querySelector(n.container??"body");this.type=n.type;this.message=n.message;this.duration=(n.duration??5)*1e3;this.destroy=n.destroy??!0;this.expires=n.expires??!0;this.withProgress=n.withProgress??!1;this.info=n.info??!0;this.close=n.close??!0;this.intervals={close:this.expires?setTimeout(this.#closeAlert.bind(this),this.duration):null,progress:setInterval(this.#progress.bind(this),this.duration/100)};this.#build();this.#addSelectors();this.#addListeners()}#build(){let n=this.#buildAlertContainer(),t=this.#buildAlertMessage(),i=this.#buildInfoIcon(),r=this.#buildCloseIcon(),u=this.#buildProgressBar();n.append(i,t,r,u);this.alert=n;this.container.append(n)}#progress(){this.progressBar&&this.expires&&(this.progressBar.value>=100?(this.#closeAlert.bind(this),clearInterval(this.intervals.progress)):this.progressBar.value++)}#closeAlert(){this.progressBar&&this.expires&&(this.progressBar.value=100);clearInterval(this.intervals.close);setTimeout(()=>this.alert.classList.replace("alert-is-open","alert-is-closed"),this.expires?500:0);this.destroy&&setTimeout(()=>this.alert.parentElement?.removeChild(this.alert),this.expires?1e3:500)}#addSelectors(){this.button=this.alert.querySelector(".alert__close")??this.button;this.progressBar=this.alert.querySelector(".alert__progress")}#addListeners(){this.button?.addEventListener("click",this.#closeAlert.bind(this))}#buildAlertContainer(){return this.#createElement("div",{"class":"alert alert-"+this.type+" alert-is-open",role:"alert"})}#buildAlertMessage(){return this.#createElement("p",{"class":"alert__message",text:this.message})}#buildProgressBar(){return this.withProgress?this.#createElement("progress",{"class":"alert__progress",value:0,max:100}):""}#buildInfoIcon(){switch(typeof this.info){case"boolean":return this.info?this.#toHTML('<svg aria-hidden="true" class="alert__info" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"><\/path><\/svg>'):"";case"string":return this.#toHTML(`<span class="alert__info">${this.info}</span>`)}}#buildCloseIcon(){switch(typeof this.close){case"boolean":return this.close?this.#toHTML('<button class="alert__close" role="button"><svg aria-hidden="true" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"><\/path><\/svg><\/button>'):"";case"string":return this.button=this.#toHTML(`('<button class="alert__close" role="button">${this.close}</button>`),this.button}}#createElement(n,t={}){let i=document.createElement(n);for(let n in t){if(n==="text"){i.innerHTML=t[n];continue}i.setAttribute(n,t[n])}return i}#toHTML(n){let t=n.match(/(?!<!DOCTYPE)<([^\s>]+)(\s|>)+/)[1],i=document.createElement("html"),r=document.createElement(t);return i.append(r),r.outerHTML=n,t==="html"?i:i.querySelector(t)}}typeof exports!="undefined"?module.exports=Alert=$Alert:window.Alert=$Alert;document.addEventListener("scroll",()=>{setMainSlideRightLastChildOffset(this),showGetToTop(this),showFixNavbar(this)});HomeSlideMove=!1;
/*!-----------------------------------------------------
 * xZoom v1.0.15
 * (c) 2013 by Azat Ahmedov & Elman Guseynov
 * https://github.com/payalord
 * https://dribbble.com/elmanvebs
 * Apache License 2.0
 *------------------------------------------------------*/
window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){window.setTimeout(n,20)},function(n){function t(t,i){function yr(){var n=document.documentElement;return{left:(window.pageXOffset||n.scrollLeft)-(n.clientLeft||0),top:(window.pageYOffset||n.scrollTop)-(n.clientTop||0)}}function or(){var n;"circle"==r.options.lensShape&&"lens"==r.options.position&&(n=((k=d=Math.max(k,d))+2*Math.max(lt,ct))/2,s.css({"-moz-border-radius":n,"-webkit-border-radius":n,"border-radius":n}))}function sr(n,t,i,u){"lens"==r.options.position?(v.css({top:-(t-e)*dt+d/2,left:-(n-o)*kt+k/2}),r.options.bg&&(s.css({"background-image":"url("+v.attr("src")+")","background-repeat":"no-repeat","background-position":-(n-o)*kt+k/2+"px "+(-(t-e)*dt+d/2)+"px"}),i&&u&&s.css({"background-size":i+"px "+u+"px"}))):v.css({top:-nt*dt,left:-g*kt})}function hr(n,t){var i,r;1<(et=et<-1?-1:et)&&(et=1);ei<oi?r=(i=y*(ei-(ei-1)*et))/gi:i=(r=p*(oi-(oi-1)*et))*gi;pt?(ri=n,ui=t,li=i,ai=r):(pt||(vi=li=i,yi=ai=r),k=y/(kt=i/c),d=p/(dt=r/l),or(),wi(n,t),v.width(i),v.height(r),s.width(k),s.height(d),s.css({top:nt-lt,left:g-ct}),ht.css({top:-nt,left:-g}),sr(n,t,i,r))}function pr(){var i=rr,u=ur,f=fr,e=er,n=vi,t=yi;i+=(ri-i)/r.options.smoothLensMove;u+=(ui-u)/r.options.smoothLensMove;f+=(ri-f)/r.options.smoothZoomMove;e+=(ui-e)/r.options.smoothZoomMove;n+=(li-n)/r.options.smoothScale;t+=(ai-t)/r.options.smoothScale;k=y/(kt=n/c);d=p/(dt=t/l);or();wi(i,u);v.width(n);v.height(t);s.width(k);s.height(d);s.css({top:nt-lt,left:g-ct});ht.css({top:-nt,left:-g});wi(f,e);sr(i,u,n,t);rr=i;ur=u;fr=f;er=e;vi=n;yi=t;pt&&requestAnimFrame(pr)}function wi(n,t){g=(n-=o)-k/2;nt=(t-=e)-d/2;"lens"!=r.options.position&&r.options.lensCollision&&(g<0&&(g=0),k<=c&&c-k<g&&(g=c-k),c<k&&(g=c/2-k/2),nt<0&&(nt=0),d<=l&&l-d<nt&&(nt=l-d),l<d&&(nt=l/2-d/2))}function bi(){void 0!==a&&a.remove();void 0!==u&&u.remove();void 0!==it&&it.remove()}function wr(n){var t=n.attr("title"),n=n.attr("xtitle");return n||t||""}this.xzoom=!0;var wt,c,l,y,p,b,e,o,h,f,ki,di,ut,ft,a,ot,u,st,fi,cr,bt,v,s,ht,k,d,g,nt,ct,lt,kt,dt,ei,oi,gi,vt,yt,pt,lr,ar,nr,si,it,tr,vr,tt,rt,gt,ni,hi,ir,r=this,w={},ti=([],[]),ii=0,ci=0,et=0,ri=0,ui=0,li=0,ai=0,vi=0,yi=0,rr=0,ur=0,fr=0,er=0,pi=detect_old_ie(),br=/MSIE (\d+\.\d+);/.test(navigator.userAgent),at="";this.adaptive=function(){0!=tt&&0!=rt||(t.css("width",""),t.css("height",""),tt=t.width(),rt=t.height());bi();tr=n(window).width();vr=n(window).height();gt=t.width();ni=t.height();tt<gt&&(gt=tt);rt<ni&&(ni=rt);(tr<tt||vr<rt?!0:!1)?t.width("100%"):0!=tt&&t.width(tt);"fullscreen"!=hi&&(r.options.position=function(){var i=t.offset();if(y="auto"==r.options.zoomWidth?gt:r.options.zoomWidth,p="auto"==r.options.zoomHeight?ni:r.options.zoomHeight,"#"==r.options.position.substr(0,1)?w=n(r.options.position):w.length=0,0!=w.length)return!0;switch(hi){case"lens":case"inside":return!0;case"top":e=i.top;o=i.left;h=e-p;f=o;break;case"left":e=i.top;o=i.left;h=e;f=o-y;break;case"bottom":e=i.top;o=i.left;h=e+ni;f=o;break;case"right":default:e=i.top;o=i.left;h=e;f=o+gt}return!(tr<f+y||f<0)}()?hi:r.options.mposition);r.options.lensReverse||(ir=r.options.adaptiveReverse&&r.options.position==r.options.mposition)};this.xscroll=function(n){var t,i;ut=n.pageX||n.originalEvent.pageX;ft=n.pageY||n.originalEvent.pageY;n.preventDefault();n.xscale?(et=n.xscale,hr(ut,ft)):(t=-n.originalEvent.detail||n.originalEvent.wheelDelta||n.xdelta,i=ut,n=ft,pi&&(i=lr,n=ar),et+=t=0<t?-.05:.05,hr(i,n))};this.openzoom=function(i){switch(ut=i.pageX,ft=i.pageY,r.options.adaptive&&r.adaptive(),et=r.options.defaultScale,pt=!1,a=n("<div><\/div>"),""!=r.options.sourceClass&&a.addClass(r.options.sourceClass),a.css("position","absolute"),st=n("<div><\/div>"),""!=r.options.loadingClass&&st.addClass(r.options.loadingClass),st.css("position","absolute"),ot=n('<div style="position: absolute; top: 0; left: 0;"><\/div>'),a.append(st),u=n("<div><\/div>"),""!=r.options.zoomClass&&"fullscreen"!=r.options.position&&u.addClass(r.options.zoomClass),u.css({position:"absolute",overflow:"hidden",opacity:1}),r.options.title&&""!=at&&(it=n("<div><\/div>"),si=n("<div><\/div>"),it.css({position:"absolute",opacity:1}),r.options.titleClass&&si.addClass(r.options.titleClass),si.html("<span>"+at+"<\/span>"),it.append(si),r.options.fadeIn&&it.css({opacity:0})),s=n("<div><\/div>"),""!=r.options.lensClass&&s.addClass(r.options.lensClass),s.css({position:"absolute",overflow:"hidden"}),r.options.lens&&(lenstint=n("<div><\/div>"),lenstint.css({position:"absolute",background:r.options.lens,opacity:r.options.lensOpacity,width:"100%",height:"100%",top:0,left:0,"z-index":9999}),s.append(lenstint)),function(){switch(l="fullscreen"==r.options.position?(c=n(window).width(),n(window).height()):(c=t.width(),t.height()),st.css({top:l/2-st.height()/2,left:c/2-st.width()/2}),(b=r.options.rootOutput||"fullscreen"==r.options.position?t.offset():t.position()).top=Math.round(b.top),b.left=Math.round(b.left),r.options.position){case"fullscreen":e=yr().top;o=yr().left;f=h=0;break;case"inside":e=b.top;o=b.left;f=h=0;break;case"top":e=b.top;o=b.left;h=e-p;f=o;break;case"left":e=b.top;o=b.left;h=e;f=o-y;break;case"bottom":e=b.top;o=b.left;h=e+l;f=o;break;case"right":default:e=b.top;o=b.left;h=e;f=o+c}e-=a.outerHeight()/2;o-=a.outerWidth()/2;"#"==r.options.position.substr(0,1)?w=n(r.options.position):w.length=0;0==w.length&&"inside"!=r.options.position&&"fullscreen"!=r.options.position?(r.options.adaptive&&tt&&rt||(tt=c,rt=l),y="auto"==r.options.zoomWidth?c:r.options.zoomWidth,p="auto"==r.options.zoomHeight?l:r.options.zoomHeight,h+=r.options.Yoffset,f+=r.options.Xoffset,u.css({width:y+"px",height:p+"px",top:h,left:f}),"lens"!=r.options.position&&wt.append(u)):"inside"==r.options.position||"fullscreen"==r.options.position?(y=c,p=l,u.css({width:y+"px",height:p+"px"}),a.append(u)):(y=w.width(),p=w.height(),r.options.rootOutput?(h=w.offset().top,f=w.offset().left,wt.append(u)):(h=w.position().top,f=w.position().left,w.parent().append(u)),h+=(w.outerHeight()-p-u.outerHeight())/2,f+=(w.outerWidth()-y-u.outerWidth())/2,u.css({width:y+"px",height:p+"px",top:h,left:f}));r.options.title&&""!=at&&("inside"==r.options.position||"lens"==r.options.position||"fullscreen"==r.options.position?(ki=h,di=f,a.append(it)):(ki=h+(u.outerHeight()-p)/2,di=f+(u.outerWidth()-y)/2,wt.append(it)),it.css({width:y+"px",height:p+"px",top:ki,left:di}));a.css({width:c+"px",height:l+"px",top:e,left:o});ot.css({width:c+"px",height:l+"px"});r.options.tint&&"inside"!=r.options.position&&"fullscreen"!=r.options.position?ot.css("background-color",r.options.tint):pi&&ot.css({"background-image":"url("+t.attr("src")+")","background-color":"#fff"});bt=new Image;var i="";switch(br&&(i="?r="+(new Date).getTime()),bt.src=t.attr("xoriginal")+i,(v=n(bt)).css("position","absolute"),(bt=new Image).src=t.attr("src"),(ht=n(bt)).css("position","absolute"),ht.width(c),r.options.position){case"fullscreen":case"inside":u.append(v);break;case"lens":s.append(v);r.options.bg&&v.css({display:"none"});break;default:u.append(v);s.append(ht)}}(),"inside"!=r.options.position&&"fullscreen"!=r.options.position?((r.options.tint||pi)&&a.append(ot),r.options.fadeIn&&(ot.css({opacity:0}),s.css({opacity:0}),u.css({opacity:0}))):r.options.fadeIn&&u.css({opacity:0}),wt.append(a),r.eventmove(a),r.eventleave(a),r.options.position){case"inside":h-=(u.outerHeight()-u.height())/2;f-=(u.outerWidth()-u.width())/2;break;case"top":h-=u.outerHeight()-u.height();f-=(u.outerWidth()-u.width())/2;break;case"left":h-=(u.outerHeight()-u.height())/2;f-=u.outerWidth()-u.width();break;case"bottom":f-=(u.outerWidth()-u.width())/2;break;case"right":h-=(u.outerHeight()-u.height())/2}u.css({top:h,left:f});v.xon("load",function(n){if(st.remove(),!r.options.openOnSmall&&(v.width()<y||v.height()<p))return r.closezoom(),n.preventDefault(),!1;r.options.scroll&&r.eventscroll(a);"inside"!=r.options.position&&"fullscreen"!=r.options.position?(a.append(s),r.options.fadeIn?(ot.fadeTo(300,r.options.tintOpacity),s.fadeTo(300,1),u.fadeTo(300,1)):(ot.css({opacity:r.options.tintOpacity}),s.css({opacity:1}),u.css({opacity:1}))):r.options.fadeIn?u.fadeTo(300,1):u.css({opacity:1});r.options.title&&""!=at&&(r.options.fadeIn?it.fadeTo(300,1):it.css({opacity:1}));vt=v.width();yt=v.height();r.options.adaptive&&(c<tt||l<rt)&&(ht.width(c),ht.height(l),vt*=c/tt,yt*=l/rt,v.width(vt),v.height(yt));vi=li=vt;yi=ai=yt;gi=vt/yt;ei=vt/y;oi=yt/p;for(var t,f=["padding-","border-"],i=lt=ct=0;i<f.length;i++)t=parseFloat(s.css(f[i]+"top-width")),lt+=t!=t?0:t,t=parseFloat(s.css(f[i]+"bottom-width")),lt+=t!=t?0:t,t=parseFloat(s.css(f[i]+"left-width")),ct+=t!=t?0:t,t=parseFloat(s.css(f[i]+"right-width")),ct+=t!=t?0:t;lt/=2;ct/=2;fr=rr=ri=ut;er=ur=ui=ft;hr(ut,ft);r.options.smooth&&(pt=!0,requestAnimFrame(pr));r.eventclick(a)})};this.movezoom=function(n){ut=n.pageX;ft=n.pageY;pi&&(lr=ut,ar=ft);var t=ut-o,i=ft-e;ir&&(n.pageX-=2*(t-c/2),n.pageY-=2*(i-l/2));(t<0||c<t||i<0||l<i)&&a.trigger("mouseleave");r.options.smooth?(ri=n.pageX,ui=n.pageY):(or(),wi(n.pageX,n.pageY),s.css({top:nt-lt,left:g-ct}),ht.css({top:-nt,left:-g}),sr(n.pageX,n.pageY,0,0))};this.eventdefault=function(){r.eventopen=function(n){n.xon("mouseenter",r.openzoom)};r.eventleave=function(n){n.xon("mouseleave",r.closezoom)};r.eventmove=function(n){n.xon("mousemove",r.movezoom)};r.eventscroll=function(n){n.xon("mousewheel DOMMouseScroll",r.xscroll)};r.eventclick=function(n){n.xon("click",function(){t.trigger("click")})}};this.eventunbind=function(){t.xoff("mouseenter");r.eventopen=function(){};r.eventleave=function(){};r.eventmove=function(){};r.eventscroll=function(){};r.eventclick=function(){}};this.init=function(i){r.options=n.extend({},n.fn.xzoom.defaults,i);wt=r.options.rootOutput?n("body"):t.parent();hi=r.options.position;ir=r.options.lensReverse&&"inside"==r.options.position;r.options.smoothZoomMove<1&&(r.options.smoothZoomMove=1);r.options.smoothLensMove<1&&(r.options.smoothLensMove=1);r.options.smoothScale<1&&(r.options.smoothScale=1);r.options.adaptive&&n(window).xon("load",function(){tt=t.width();rt=t.height();r.adaptive();n(window).resize(r.adaptive)});r.eventdefault();r.eventopen(t)};this.destroy=function(){r.eventunbind()};this.closezoom=function(){pt=!1;r.options.fadeOut?(r.options.title&&""!=at&&it.fadeOut(299),"inside"==r.options.position&&"fullscreen"==r.options.position||u.fadeOut(299),a.fadeOut(300,function(){bi()})):bi()};this.gallery=function(){for(var i=[],t=0,n=ci;n<ti.length;n++)i[t]=ti[n],t++;for(n=0;n<ci;n++)i[t]=ti[n],t++;return{index:ci,ogallery:ti,cgallery:i}};this.xappend=function(i){function f(f){bi();f.preventDefault();r.options.activeClass&&(nr.removeClass(r.options.activeClass),(nr=i).addClass(r.options.activeClass));ci=n(this).data("xindex");r.options.fadeTrans&&((cr=new Image).src=t.attr("src"),(fi=n(cr)).css({position:"absolute",top:t.offset().top,left:t.offset().left,width:t.width(),height:t.height()}),n(document.body).append(fi),fi.fadeOut(200,function(){fi.remove()}));var e=u.attr("href"),f=i.attr("xpreview")||i.attr("src");at=wr(i);i.attr("title")&&t.attr("title",i.attr("title"));t.attr("xoriginal",e);t.removeAttr("style");t.attr("src",f);r.options.adaptive&&(tt=t.width(),rt=t.height())}var u=i.parent();ti[ii]=u.attr("href");u.data("xindex",ii);0==ii&&r.options.activeClass&&(nr=i).addClass(r.options.activeClass);0==ii&&r.options.title&&(at=wr(i));ii++;r.options.hover&&u.xon("mouseenter",u,f);u.xon("click",u,f)};this.init(i)}n.fn.xon=n.fn.on||n.fn.bind;n.fn.xoff=n.fn.off||n.fn.bind;n.fn.xzoom=function(i){var r,f,e,u;if(this.selector){u=this.selector.split(",");for(e in u)u[e]=n.trim(u[e]);this.each(function(e){if(1==u.length)if(0==e){if(void 0!==(r=n(this)).data("xzoom"))return r.data("xzoom");r.x=new t(r,i)}else void 0!==r.x&&(f=n(this),r.x.xappend(f));else if(n(this).is(u[0])&&0==e){if(void 0!==(r=n(this)).data("xzoom"))return r.data("xzoom");r.x=new t(r,i)}else void 0===r.x||n(this).is(u[0])||(f=n(this),r.x.xappend(f))})}else this.each(function(u){if(0==u){if(void 0!==(r=n(this)).data("xzoom"))return r.data("xzoom");r.x=new t(r,i)}else void 0!==r.x&&(f=n(this),r.x.xappend(f))});return void 0!==r&&(r.data("xzoom",r.x),n(r).trigger("xzoom_ready"),r.x)};n.fn.xzoom.defaults={position:"right",mposition:"inside",rootOutput:!0,Xoffset:0,Yoffset:0,fadeIn:!0,fadeTrans:!0,fadeOut:!1,smooth:!0,smoothZoomMove:3,smoothLensMove:1,smoothScale:6,defaultScale:0,scroll:!0,tint:!1,tintOpacity:.5,lens:!1,lensOpacity:.5,lensShape:"box",lensCollision:!0,lensReverse:!1,openOnSmall:!0,zoomWidth:"auto",zoomHeight:"auto",sourceClass:"xzoom-source",loadingClass:"xzoom-loading",lensClass:"xzoom-lens",zoomClass:"xzoom-preview",activeClass:"xactive",hover:!1,adaptive:!0,adaptiveReverse:!1,title:!1,titleClass:"xzoom-caption",bg:!1}}(jQuery);